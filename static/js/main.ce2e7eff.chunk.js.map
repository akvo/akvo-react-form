{"version":3,"sources":["../../src/custom/Maps.jsx","../../src/index.js","App.js","index.js"],"names":["DefaultIcon","iconUrl","shadowUrl","iconShadow","L","defaultCenter","lat","lng","DraggableMarker","changePos","position","markerRef","useRef","eventHandlers","useMemo","dragend","marker","newPos","useMapEvents","click","e","ref","draggable","MapRef","center","useMap","map","Maps","form","id","useState","setPosition","onChange","cname","parseFloat","justify","style","marginBottom","span","paddingRight","placeholder","width","value","min","max","paddingLeft","className","zoom","scrollWheelZoom","height","attribution","url","Question","fields","cascade","setValue","rules","f","validator","Promise","Error","rule","type","mapRules","key","name","label","required","direction","o","mode","options","row","disabled","hidden","sytle","Webform","forms","onFinish","Form","layout","onValuesChange","values","console","title","g","htmlType","formData","administration","App","log","data","Object","keys","v","question","parseInt","filter","x","fontSize","src","theme","displayDataTypes","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.ce2e7eff.chunk.js","sourcesContent":["import React, { useState, useRef, useMemo } from 'react'\nimport L from 'leaflet'\nimport {\n  MapContainer,\n  TileLayer,\n  Marker,\n  useMapEvents,\n  useMap\n} from 'react-leaflet'\nimport 'leaflet/dist/leaflet.css'\nimport icon from 'leaflet/dist/images/marker-icon.png'\nimport iconShadow from 'leaflet/dist/images/marker-shadow.png'\nimport { Row, Col, InputNumber } from 'antd'\n\nconst DefaultIcon = L.icon({\n  iconUrl: icon,\n  shadowUrl: iconShadow\n})\n\nL.Marker.prototype.options.icon = DefaultIcon\n\nconst defaultCenter = {\n  lat: 0,\n  lng: 0\n}\n\nconst DraggableMarker = ({ changePos, position }) => {\n  const markerRef = useRef(null)\n  const eventHandlers = useMemo(\n    () => ({\n      dragend() {\n        const marker = markerRef.current\n        if (marker != null) {\n          const newPos = marker.getLatLng()\n          changePos(newPos)\n        }\n      }\n    }),\n    []\n  )\n\n  useMapEvents({\n    click(e) {\n      const newPos = e.latlng\n      changePos(newPos)\n    }\n  })\n\n  if (!position?.lat && !position?.lng) {\n    return ''\n  }\n\n  return (\n    <Marker\n      eventHandlers={eventHandlers}\n      position={position}\n      ref={markerRef}\n      draggable\n    />\n  )\n}\n\nconst MapRef = ({ center }) => {\n  const map = useMap()\n  map.panTo(center)\n  return null\n}\n\nconst Maps = ({ form, id, setValue, center }) => {\n  const [position, setPosition] = useState({ lat: null, lng: null })\n\n  const changePos = (newPos) => {\n    setPosition(newPos)\n    if (newPos?.lat && newPos?.lng) {\n      form.setFieldsValue({ [id]: newPos })\n    }\n  }\n\n  const onChange = (cname, e) => {\n    changePos({ ...position, [cname]: parseFloat(e) })\n  }\n\n  return (\n    <div>\n      <Row justify='space-between' style={{ marginBottom: '10px' }}>\n        <Col span={12} style={{ paddingRight: '10px' }}>\n          <InputNumber\n            placeholder='Latitude'\n            style={{ width: '100%' }}\n            value={position?.lat || null}\n            min='-90'\n            max='90'\n            onChange={(e) => onChange('lat', e)}\n          />\n        </Col>\n        <Col span={12} style={{ paddingLeft: '10px' }}>\n          <InputNumber\n            placeholder='Longitude'\n            className='site-input-right'\n            style={{ width: '100%' }}\n            value={position?.lng || null}\n            min='-180'\n            max='180'\n            onChange={(e) => onChange('lng', e)}\n          />\n        </Col>\n      </Row>\n      <Row>\n        <Col span={24}>\n          <MapContainer\n            zoom={13}\n            scrollWheelZoom={false}\n            style={{ height: '300px', width: '100%' }}\n          >\n            <MapRef\n              center={\n                position?.lat && position?.lng\n                  ? position\n                  : center || defaultCenter\n              }\n            />\n            <TileLayer\n              attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n              url='https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'\n            />\n            <DraggableMarker\n              form={form}\n              id={id}\n              changePos={changePos}\n              position={position}\n            />\n          </MapContainer>\n        </Col>\n      </Row>\n    </div>\n  )\n}\n\nexport default Maps\n","import React, { useState } from 'react'\nimport {\n  Row,\n  Col,\n  Card,\n  Space,\n  Button,\n  Form,\n  Input,\n  InputNumber,\n  Radio,\n  Select,\n  DatePicker,\n  Cascader\n} from 'antd'\nimport TextArea from 'antd/lib/input/TextArea'\nimport 'antd/dist/antd.css'\nimport './styles.module.css'\nimport Maps from './custom/Maps'\n\nconst mapRules = ({ name, rule, type }) => {\n  if (type === 'number') {\n    return [{ ...rule, type: 'number' }]\n  }\n  return [{}]\n}\n\nconst Question = ({ fields, cascade, form }) => {\n  const [value, setValue] = useState(null)\n  return fields.map((f, key) => {\n    let rules = []\n    if (f?.required) {\n      rules = [\n        {\n          validator: (_, value) =>\n            value\n              ? Promise.resolve()\n              : Promise.reject(new Error(`${f.name} is required`))\n        }\n      ]\n    }\n    if (f.rule) {\n      rules = [...rules, ...mapRules(f)]\n    }\n    return (\n      <Form.Item\n        key={key}\n        name={f.id}\n        label={`${key + 1}. ${f.name}`}\n        rules={rules}\n        required={f?.required}\n      >\n        {f.type === 'option' ? (\n          f.option.length < 3 ? (\n            <Radio.Group>\n              <Space direction='vertical'>\n                {f.option.map((o, io) => (\n                  <Radio key={io} value={o.name}>\n                    {o.name}\n                  </Radio>\n                ))}\n              </Space>\n            </Radio.Group>\n          ) : (\n            <Select style={{ width: '100%' }}>\n              {f.option.map((o, io) => (\n                <Select.Option key={io} value={o.name}>\n                  {o.name}\n                </Select.Option>\n              ))}\n            </Select>\n          )\n        ) : f.type === 'multiple_option' ? (\n          <Select mode='multiple' style={{ width: '100%' }}>\n            {f.option.map((o, io) => (\n              <Select.Option key={io} value={o.name}>\n                {o.name}\n              </Select.Option>\n            ))}\n          </Select>\n        ) : f.type === 'cascade' ? (\n          <Cascader options={cascade[f.option]} />\n        ) : f.type === 'date' ? (\n          <DatePicker style={{ width: '100%' }} />\n        ) : f.type === 'number' ? (\n          <InputNumber style={{ width: '100%' }} />\n        ) : f.type === 'text' ? (\n          <TextArea row={4} />\n        ) : f.type === 'geo' ? (\n          <Col>\n            <Input value={value} disabled hidden />\n            <Maps\n              form={form}\n              setValue={setValue}\n              id={f.id}\n              center={f?.center}\n            />\n          </Col>\n        ) : (\n          <Input sytle={{ width: '100%' }} />\n        )}\n      </Form.Item>\n    )\n  })\n}\n\nexport const Webform = ({ forms, onChange, onFinish, style }) => {\n  const [form] = Form.useForm()\n  if (!forms?.question_group) {\n    return 'Error Format'\n  }\n\n  const onSubmit = (values) => {\n    if (onFinish) {\n      onFinish(values)\n    } else {\n      console.log(values)\n    }\n  }\n\n  const onValuesChange = (value) => {\n    if (onChange) {\n      onChange(value)\n    }\n  }\n\n  return (\n    <Form\n      form={form}\n      layout='vertical'\n      name={forms.name}\n      onValuesChange={onValuesChange}\n      onFinish={onSubmit}\n      style={style}\n    >\n      {forms?.question_group.map((g, key) => {\n        return (\n          <Card key={key} title={g.name || `Section ${key + 1}`}>\n            <Question fields={g.question} cascade={forms.cascade} form={form} />\n          </Card>\n        )\n      })}\n      <Row>\n        <Col span={24}>\n          <Card>\n            <Form.Item>\n              <Button type='primary' htmlType='submit'>\n                Submit\n              </Button>\n            </Form.Item>\n          </Card>\n        </Col>\n      </Row>\n    </Form>\n  )\n}\n","import React from 'react'\nimport ReactJson from 'react-json-view'\nimport { Webform } from 'akvo-react-form'\nimport * as forms from './example.json'\nimport * as cascade from './example-cascade.json'\nimport 'akvo-react-form/dist/index.css'\n\nconst formData = {\n  ...forms.default,\n  cascade: { administration: cascade.default }\n}\n\nconst App = () => {\n  const onChange = (value) => {\n    console.log(value)\n  }\n  const onFinish = (values) => {\n    const data = Object.keys(values).map((v) => {\n      if (values[v]) {\n        return { question: parseInt(v), value: values[v] }\n      }\n      return false\n    })\n    console.log(data.filter((x) => x))\n  }\n  return (\n    <div>\n      <div className='half-width'>\n        <Webform\n          forms={formData}\n          onChange={onChange}\n          onFinish={onFinish}\n          style={{ fontSize: '30px' }}\n        />\n      </div>\n      <div className='half-width json-source'>\n        <ReactJson src={formData} theme='monokai' displayDataTypes={false} />\n      </div>\n    </div>\n  )\n}\n\nexport default App\n","import './index.css'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}